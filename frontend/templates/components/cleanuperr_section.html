<section id="cleanuperrSection" class="content-section">
    <div class="section-header">
        <div class="header-buttons">
            <button id="backToAppsButton" class="back-button">
                <i class="fas fa-arrow-left"></i> Back to Apps
            </button>
        </div>
        <h2>Cleanuperr</h2>
    </div>
    
    <div class="cleanuperr-container">
        <div class="cleanuperr-info-box">
            <div class="cleanuperr-header">
                <div class="cleanuperr-logo">
                    <img src="./static/logo/apps/cleanuperr.png" alt="Cleanuperr Logo" class="app-logo">
                </div>
                <div class="cleanuperr-title">
                    <h3>Cleanuperr by <a href="https://github.com/Flaminel" target="_blank">Flaminel</a></h3>
                </div>
            </div>
            
            <div class="github-info-container">
                <a href="https://github.com/flmorg/cleanuperr" class="github-link" target="_blank">
                    <i class="fab fa-github"></i> View on GitHub
                </a>
                <div class="github-stars">
                    <i class="fas fa-star star-icon"></i>
                    <span id="cleanuperr-stars-count">Loading...</span>
                </div>
            </div>

            <div class="cleanuperr-description">
                <p>Cleanuperr is a tool for automating the cleanup of unwanted or blocked files in Sonarr, Radarr, and supported download clients like qBittorrent. It removes incomplete or blocked downloads, updates queues, and enforces blacklists or whitelists to manage file selection. After removing blocked content, Cleanuperr can also trigger a search to replace the deleted shows/movies.</p>
                
                <h4>Key Features:</h4>
                <ul>
                    <li>Strike system to mark stalled or downloads stuck in metadata downloading</li>
                    <li>Remove and block downloads that reached a maximum number of strikes</li>
                    <li>Remove and block downloads that have a low download speed or high estimated completion time</li>
                    <li>Remove downloads blocked by qBittorrent or by Cleanuperr's content blocker</li>
                    <li>Trigger a search for downloads removed from the *arrs</li>
                    <li>Clean up downloads that have been seeding for a certain amount of time</li>
                    <li>Notify on strike or download removal</li>
                    <li>Ignore certain torrent hashes, categories, tags or trackers from being processed</li>
                </ul>
                
                <div class="origin-section">
                    <p>Cleanuperr was created primarily to address malicious files, such as *.lnk or *.zipx, that were getting stuck in Sonarr/Radarr and required manual intervention. It supports both qBittorrent's built-in exclusion features and its own blocklist-based system.</p>
                </div>
                
                <div class="author-section">
                    <div class="author-info">
                        <img src="https://avatars.githubusercontent.com/u/6135377?v=4" alt="Flaminel" class="author-avatar">
                        <div class="author-details">
                            <h4>About the Author</h4>
                            <p>Cleanuperr is developed by <a href="https://github.com/Flaminel" target="_blank">Flaminel</a>, a passionate developer focused on creating tools that enhance the media server experience.</p>
                        </div>
                    </div>
                </div>
                
                <div class="collaboration-note">
                    <p>Huntarr is proud to feature Cleanuperr as part of our commitment to helping other projects grow. We believe in collaboration across the media server community to create better tools for everyone.</p>
                </div>
                
                <div class="cleanuperr-cta">
                    <a href="https://github.com/flmorg/cleanuperr" class="button primary-button" target="_blank">
                        <i class="fab fa-github"></i> GitHub
                    </a>
                    <a href="https://discord.com/invite/SCtMCgtsc4" class="button discord-button" target="_blank">
                        <i class="fab fa-discord"></i> Join Discord
                    </a>
                    <a href="https://github.com/flmorg/cleanuperr#installation" class="button secondary-button" target="_blank">
                        <i class="fas fa-book"></i> Installation Guide
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    #cleanuperrSection {
        padding: 20px;
        max-width: 100%;
        display: none;
    }
    
    #cleanuperrSection.active {
        display: block;
    }
    
    .cleanuperr-container {
        width: 100%;
        margin-bottom: 20px;
    }
    
    .cleanuperr-info-box {
        background: linear-gradient(135deg, rgba(28, 36, 54, 0.9), rgba(24, 32, 48, 0.8));
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        margin-bottom: 20px;
        border: 1px solid rgba(90, 109, 137, 0.2);
    }
    
    .cleanuperr-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 20px;
    }
    
    .cleanuperr-logo {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .app-logo {
        width: 64px;
        height: 64px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    
    .github-info-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        margin: 15px 0;
        padding: 15px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        border: 1px solid rgba(90, 109, 137, 0.2);
    }
    
    .github-stars {
        display: flex;
        align-items: center;
        gap: 5px;
        font-size: 16px;
    }
    
    .star-icon {
        color: #f1c40f;
    }
    
    .cleanuperr-title {
        flex: 2;
    }
    
    .cleanuperr-title h3 {
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 24px;
        color: #e0e6ed;
    }
    
    .github-link {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 6px 12px;
        background: linear-gradient(135deg, #2c3e50, #1a2632);
        border-radius: 6px;
        color: #e0e6ed;
        text-decoration: none;
        font-size: 14px;
        transition: all 0.3s ease;
        border: 1px solid rgba(90, 109, 137, 0.3);
    }
    
    .github-link:hover {
        background: linear-gradient(135deg, #34495e, #2c3e50);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }
    
    .cleanuperr-description {
        color: #e0e6ed;
        line-height: 1.6;
    }
    
    .cleanuperr-description h4 {
        margin-top: 20px;
        margin-bottom: 10px;
        color: #3498db;
    }
    
    .cleanuperr-description ul {
        margin-left: 20px;
        margin-bottom: 20px;
    }
    
    .cleanuperr-description li {
        margin-bottom: 8px;
    }
    
    .author-section {
        margin: 30px 0;
        padding: 20px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        border: 1px solid rgba(90, 109, 137, 0.2);
    }
    
    .author-info {
        display: flex;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
    }
    
    .author-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        border: 3px solid #3498db;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    .author-details {
        flex: 1;
    }
    
    .author-details h4 {
        margin-top: 0;
        color: #3498db;
    }
    
    .origin-section {
        margin: 25px 0;
        padding: 15px;
        background: rgba(41, 128, 185, 0.1);
        border-radius: 8px;
        border: 1px solid rgba(41, 128, 185, 0.2);
    }
    
    .collaboration-note {
        margin: 30px 0;
        padding: 15px;
        background: rgba(52, 152, 219, 0.1);
        border-left: 4px solid #3498db;
        border-radius: 0 8px 8px 0;
    }
    
    .cleanuperr-cta {
        display: flex;
        gap: 15px;
        margin-top: 30px;
        flex-wrap: wrap;
    }
    
    .button, .back-button {
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: bold;
        text-decoration: none;
        text-align: center;
        transition: all 0.3s ease;
    }
    
    .back-button {
        background: linear-gradient(135deg, #34495e, #2c3e50);
        color: white;
        border: none;
        display: flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    .back-button:hover {
        background: linear-gradient(135deg, #3a536b, #34495e);
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
    }
    
    .header-buttons {
        margin-right: 20px;
    }
    
    .primary-button {
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        border: none;
    }
    
    .primary-button:hover {
        background: linear-gradient(135deg, #2980b9, #2471a3);
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
    }
    
    .discord-button {
        background: linear-gradient(135deg, #5865F2, #4752C4);
        color: white;
        border: none;
    }
    
    .discord-button:hover {
        background: linear-gradient(135deg, #4752C4, #3C45A5);
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(88, 101, 242, 0.4);
    }
    
    .secondary-button {
        background: transparent;
        color: #3498db;
        border: 1px solid #3498db;
    }
    
    .secondary-button:hover {
        background: rgba(52, 152, 219, 0.1);
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(52, 152, 219, 0.2);
    }
    
    @media (max-width: 768px) {
        .cleanuperr-header {
            flex-direction: column;
        }
        
        .cleanuperr-logo {
            width: 100%;
        }
        
        .author-info {
            flex-direction: column;
            text-align: center;
        }
        
        .cleanuperr-cta {
            flex-direction: column;
        }
        
        .button {
            width: 100%;
        }
    }
</style>

<script>
    // Add event listener to the back button to return to Apps section
    document.addEventListener('DOMContentLoaded', function() {
        const backToAppsButton = document.getElementById('backToAppsButton');
        if (backToAppsButton) {
            backToAppsButton.addEventListener('click', function() {
                // Hide Cleanuperr section
                document.getElementById('cleanuperrSection').classList.remove('active');
                
                // Show Apps section
                document.getElementById('appsSection').classList.add('active');
                
                // Update the current section in the main UI
                if (huntarrUI) {
                    huntarrUI.currentSection = 'apps';
                    
                    // Update the page title
                    const pageTitleElement = document.getElementById('currentPageTitle');
                    if (pageTitleElement) {
                        pageTitleElement.textContent = 'Apps';
                    }
                    
                    // Update the selected menu item
                    const menuItems = document.querySelectorAll('.nav-item');
                    menuItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('data-section') === 'apps') {
                            item.classList.add('active');
                        }
                    });
                    
                    // Reset the app selector to a default app (not Cleanuperr)
                    const appsAppSelect = document.getElementById('appsAppSelect');
                    if (appsAppSelect) {
                        // Set to the first option that isn't Cleanuperr
                        for (let i = 0; i < appsAppSelect.options.length; i++) {
                            if (appsAppSelect.options[i].value !== 'cleanuperr') {
                                appsAppSelect.selectedIndex = i;
                                break;
                            }
                        }
                    }
                }
            });
        }
    });
    
    // Load GitHub star count for Cleanuperr
    function loadCleanuperrStarCount() {
        HuntarrUtils.fetchWithTimeout('https://api.github.com/repos/flmorg/cleanuperr')
            .then(response => {
                if (!response.ok) {
                    // Handle rate limiting or other errors
                    if (response.status === 403) {
                        console.warn('GitHub API rate limit likely exceeded.');
                        throw new Error('Rate limited');
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                const starsElement = document.getElementById('cleanuperr-stars-count');
                if (starsElement && data && data.stargazers_count !== undefined) {
                    starsElement.textContent = data.stargazers_count;
                } else if (starsElement) {
                    starsElement.textContent = 'N/A';
                }
            })
            .catch(error => {
                console.error('Error loading Cleanuperr star count from GitHub:', error);
                const starsElement = document.getElementById('cleanuperr-stars-count');
                if (starsElement) {
                    starsElement.textContent = error.message === 'Rate limited' ? 'Rate Limited' : 'Error';
                }
            });
    }
    
    // Load star count when the page is loaded
    loadCleanuperrStarCount();
</script>
